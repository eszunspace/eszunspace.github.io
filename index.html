<!doctype html>
<html lang="es">

<head>
  <meta name="title" content="INICIO ‚Äì EsZunSpace">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>INICIO ‚Äì EsZunSpace</title>
  <!-- Social preview -->
  <meta name="description" content="Descubre EsZunSpace: cohetes, motores, sat√©lites y lanzamientos.">
  <link rel="canonical" href="https://eszunspace.es/">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="EsZunSpace">
  <meta property="og:title" content="INICIO ‚Äì EsZunSpace">
  <meta property="og:description" content="Descubre EsZunSpace: cohetes, motores, sat√©lites y lanzamientos.">
  <meta property="og:url" content="https://eszunspace.es/">
  <meta property="og:image" content="https://eszunspace.es/logoarriba.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="INICIO ‚Äì EsZunSpace">
  <meta name="twitter:description" content="Descubre EsZunSpace: cohetes, motores, sat√©lites y lanzamientos.">
  <meta name="twitter:image" content="https://eszunspace.es/logoarriba.jpg">
  <meta name="theme-color" content="#0b0b0f">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Space+Grotesk:wght@500;700&display=swap"
    rel="stylesheet">
  <link rel="icon" type="image/jpeg" href="logoarriba.jpg">

  <!-- Firebase SDK (loads synchronously before app.js) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>


  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <header class="topbar">
    <div class="nav-shell">
      <a class="brand" href="index.html" aria-label="Ir a inicio">
        <img src="logoarriba.jpg" alt="Logo de EsZunSpace" width="36" height="36">
        <span class="title">EsZunSpace</span>
      </a>

      <!-- Toggle s√≥lo visible en m√≥vil -->
      <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false" aria-label="Abrir men√∫">
        <svg width="24" height="24" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
        </svg>
      </button>

      <nav id="primary-menu" class="menu" role="navigation" aria-label="Men√∫ principal">
        <a href="calendario.html">Calendario</a>
        <a href="cohetes.html">Cohetes</a>
        <a href="motores.html">Motores</a>
        <a href="satelites.html">Sat√©lites</a>
        <a href="lanzamientos.html">Lanzamientos</a>
        <a href="stream.html">Stream</a>
        <div id="mobile-logout-section"
          style="display:none; margin-top:8px; padding-top:8px; border-top:1px solid rgba(255,255,255,.12);">
          <button class="btn ghost" onclick="logout()" style="width:100%; justify-content:center;">Cerrar
            sesi√≥n</button>
        </div>
      </nav>

      <div class="user-section">
        <div id="user-display" style="display:none;">
          <div class="user-info" onclick="showProfileModal()" role="button" tabindex="0" aria-label="Ver perfil">
            <div class="user-avatar" id="user-avatar">U</div>
            <span class="user-name" id="user-name">Usuario</span>
          </div>
          <button class="btn ghost" onclick="logout()">Salir</button>
        </div>
        <button id="login-btn" class="btn primary" onclick="showLoginModal()">Iniciar sesi√≥n</button>
      </div>

      <!-- Botones flotantes de Contacto y Actualizaciones -->
      <button class="secondary-btn secondary-btn-left" onclick="showContactModal()">Contacto</button>
      <button class="secondary-btn secondary-btn-right" onclick="showUpdatesModal()">Actualizaciones</button>
    </div>
  </header>

  <!-- Modal de Actualizaciones -->
  <div id="updates-modal" class="updates-overlay">
    <div class="updates-card">
      <div class="updates-header">
        <h2 class="updates-title">üöÄ Actualizaciones</h2>
        <button class="updates-close" onclick="closeUpdatesModal()" aria-label="Cerrar">&times;</button>
      </div>

      <!-- Formulario para crear actualizaciones (solo visible para Esstor) -->
      <div id="update-admin-form" class="update-admin-form" style="display: none;">
        <h3 class="admin-form-title">‚ûï Nueva Actualizaci√≥n</h3>
        <div class="form-group">
          <input type="text" id="update-title-input" placeholder="üèÜ T√≠tulo de la actualizaci√≥n" class="update-input">
        </div>
        <div class="form-group">
          <textarea id="update-desc-input" placeholder="Descripci√≥n detallada de la actualizaci√≥n..."
            class="update-textarea" rows="5"></textarea>
        </div>
        <div class="form-group">
          <label class="update-label">Imagen (opcional)</label>
          <input type="file" id="update-image-file" accept="image/*" class="update-file-input">
          <input type="hidden" id="update-image-base64">
          <div id="update-image-preview" class="update-image-preview"></div>
        </div>
        <div class="form-row">
          <div class="form-group" style="flex:1;">
            <input type="url" id="update-link-input" placeholder="URL del enlace (opcional)" class="update-input">
          </div>
          <div class="form-group" style="flex:1;">
            <input type="text" id="update-link-text-input" placeholder="Texto del bot√≥n" class="update-input"
              value="Ver m√°s">
          </div>
        </div>
        <button class="btn primary" onclick="createUpdate()">Publicar Actualizaci√≥n</button>
      </div>

      <div class="updates-content" id="updates-list">
        <div class="loading">Cargando actualizaciones...</div>
      </div>
    </div>
  </div>

  <!-- Modal de Detalle de Actualizaci√≥n -->
  <div id="update-detail-modal" class="update-detail-overlay">
    <div class="update-detail-card">
      <button class="update-detail-close" onclick="closeUpdateDetail()" aria-label="Cerrar">&times;</button>
      <div id="update-detail-content">
        <!-- Content will be inserted by JavaScript -->
      </div>
    </div>
  </div>

  <!-- Modal de Contacto / Chat -->
  <div id="contact-modal" class="contact-overlay">
    <div class="contact-card">
      <div class="contact-header">
        <h2 class="contact-title">üí¨ Contacto con EsZunSpace</h2>
        <div class="contact-header-actions">
          <button id="chat-mute-btn" class="chat-mute-btn" onclick="toggleChatMute()" title="Silenciar notificaciones">
            <svg id="mute-icon-on" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
              stroke-width="2" style="display:none">
              <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
              <line x1="23" y1="9" x2="17" y2="15"></line>
              <line x1="17" y1="9" x2="23" y2="15"></line>
            </svg>
            <svg id="mute-icon-off" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
              stroke-width="2">
              <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
              <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path>
            </svg>
          </button>
          <button class="contact-close" onclick="closeContactModal()" aria-label="Cerrar">&times;</button>
        </div>
      </div>

      <!-- Notification Sound -->
      <audio id="chat-notification-sound" preload="auto">
        <source
          src="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAABhgC7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7//////////////////////////////////////////////////////////////////8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJAAAAAAAAAAAAYYoRwmHAAAAAAD/+1DEAAAGAAGn9AAAIwvBq/80IAAAAH/+5B//5cP/E5//yhz/+XBz/Lh/8uH5c//l3/y7////lwc//y4f+U//4AABbWFpbmUtbG9vcC1wb3AtdXAtMDEuAgQGCAoMDhASFBYYGh4gJCgsMDQ4PEBIUFhgaHiAoMDQAQEDEREhMTFBQWGBgaHBweHh8QEhMUFhgcHh8fEAAQHxAQHx8f//8fEBAf/xAUHx8fHxASExgYGh4eHxAfH/8QEAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAP/7UMQAAAfwAaX/9KAAAAvBq/80IAABATGhoaGxsbHBwcHR0dHh4eHx8fHyAgICEhISMjIyUlJSYmJicnJyenp6goKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/Pz+AgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTI0NjQ="
          type="audio/mp3">
      </audio>

      <!-- Vista para usuarios no autenticados -->
      <div id="contact-login-required" class="contact-login-required">
        <div class="contact-login-icon">üîí</div>
        <h3>Inicia sesi√≥n para chatear</h3>
        <p>Necesitas una cuenta para poder enviar mensajes a Esstor y agendar misiones.</p>
        <button class="btn primary" onclick="closeContactModal(); showLoginModal();">Iniciar sesi√≥n</button>
      </div>

      <!-- Vista del chat (solo visible para usuarios autenticados) -->
      <div id="contact-chat" class="contact-chat" style="display:none;">
        <!-- Para Esstor: Lista de conversaciones -->
        <div id="chat-conversations" class="chat-conversations" style="display:none;">
          <h3 class="chat-section-title">üì® Conversaciones</h3>
          <div id="conversations-list" class="conversations-list">
            <!-- Las conversaciones se cargar√°n aqu√≠ -->
          </div>
        </div>

        <!-- √Årea de mensajes -->
        <div id="chat-messages-area" class="chat-messages-area">
          <div id="chat-partner-info" class="chat-partner-info">
            <button id="chat-back-btn" class="chat-back-btn" onclick="backToConversations()" title="Volver">‚Üê</button>
            <span class="chat-partner-avatar">E</span>
            <div class="chat-partner-details">
              <div class="chat-partner-name-row">
                <span class="chat-partner-name">Esstor</span>
                <span id="chat-partner-status-dot" class="status-dot offline" title="Desconectado"></span>
              </div>
              <span id="chat-partner-status-text" class="chat-partner-status">Admin de EsZunSpace</span>
            </div>
          </div>
          <div id="chat-messages" class="chat-messages">
            <div class="chat-welcome">
              <p>üëã ¬°Hola! Escribe tu mensaje para contactar con Esstor.</p>
              <p class="chat-hint">Puedes agendar misiones, hacer preguntas o solicitar informaci√≥n.</p>
            </div>
          </div>
          <div id="typing-indicator" class="typing-indicator" style="display:none;">
            <span class="typing-dot"></span>
            <span class="typing-dot"></span>
            <span class="typing-dot"></span>
            <span class="typing-text">escribiendo...</span>
          </div>
          <!-- Attachment Preview -->
          <div id="chat-attachment-preview" class="chat-attachment-preview" style="display:none;">
            <div class="attachment-preview-content">
              <img id="attachment-preview-img" src="" alt="Preview" style="display:none;">
              <div id="attachment-preview-file" class="attachment-preview-file" style="display:none;">
                <span class="attachment-file-icon">üìÑ</span>
                <span id="attachment-file-name"></span>
              </div>
            </div>
            <button type="button" class="attachment-remove-btn" onclick="clearAttachment()"
              title="Quitar archivo">‚úï</button>
          </div>
          <form id="chat-form" class="chat-form" onsubmit="sendChatMessage(event)">
            <input type="file" id="chat-file-input" accept="image/*,.pdf,.doc,.docx,.txt,.zip,.rar"
              style="display:none;" onchange="handleFileSelect(event)">
            <button type="button" class="chat-attach-btn" onclick="document.getElementById('chat-file-input').click()"
              title="Adjuntar archivo">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path
                  d="M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 015.66 5.66l-9.2 9.19a2 2 0 01-2.83-2.83l8.49-8.48" />
              </svg>
            </button>
            <input type="text" id="chat-input" placeholder="Escribe tu mensaje..." autocomplete="off">
            <button type="submit" class="chat-send-btn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 2L11 13M22 2L15 22L11 13M11 13L2 9L22 2" />
              </svg>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Image Lightbox Modal -->
  <div id="image-lightbox" class="image-lightbox" onclick="closeLightbox()">
    <button class="lightbox-close" onclick="closeLightbox()">&times;</button>
    <img id="lightbox-image" src="" alt="Imagen ampliada">
    <a id="lightbox-download" class="lightbox-download" download="">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
        <polyline points="7 10 12 15 17 10" />
        <line x1="12" y1="15" x2="12" y2="3" />
      </svg>
      Descargar
    </a>
  </div>





  <main class="hero">
    <div class="bg" role="img" aria-label="Fondo espacial"></div>
    <div class="overlay" aria-hidden="true"></div>
    <h1 class="brand-name"></h1>

    <!-- Dynamic Upcoming Launches -->
    <section class="launches-section">
      <div class="launches-container">
        <h2 class="launches-title">Pr√≥ximos Lanzamientos</h2>
        <div id="launches-list" class="launches-list">
          <div class="loading">Cargando...</div>
        </div>
      </div>
    </section>







    <footer>¬© <span id="year"></span> EsZunSpace ‚Äì Todos los derechos reservados</footer>
  </main>

  <!-- Event Detail Modal -->
  <div id="event-modal-overlay" class="modal-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-card" role="document">
      <div class="modal-head">
        <h3 id="modal-title" class="modal-title">Lanzamiento</h3>
        <button class="btn ghost" onclick="closeEventModal()" aria-label="Cerrar">‚úï</button>
      </div>

      <div id="modal-goal" class="goal-pill">
        <span class="goal-dot"></span>
        Ventana objetivo: ‚Äî
      </div>

      <div class="countdown-hero"><span id="modal-countdown" data-countdown-dt=""></span></div>

      <div id="modal-info" class="modal-info"></div>
      <div id="modal-desc" class="modal-desc"></div>

      <div class="timezone-note">La cuenta atr√°s se basa en la hora de <strong>Europa/Madrid</strong>.</div>

      <div class="modal-actions">
        <a id="modal-watch" class="btn primary" href="#" target="_blank" rel="noopener noreferrer"
          style="display:none;">Ver transmisi√≥n</a>
        <button class="btn ghost" onclick="closeEventModal()">Cerrar</button>
      </div>
    </div>
  </div>



  <!-- Login/Register Modal -->
  <div id="auth-modal-overlay" class="modal-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-card" role="document">
      <div class="modal-head">
        <h3 id="auth-modal-title" class="modal-title">Iniciar sesi√≥n</h3>
        <button class="btn ghost" onclick="closeAuthModal()" aria-label="Cerrar">‚úï</button>
      </div>

      <!-- Login Form -->
      <form id="login-form" class="login-form" onsubmit="handleLogin(event)">
        <div class="form-group">
          <label for="login-username">Usuario</label>
          <input type="text" id="login-username" name="username" required autocomplete="username">
        </div>
        <div class="form-group">
          <label for="login-password">Contrase√±a</label>
          <input type="password" id="login-password" name="password" required autocomplete="current-password">
          <div id="login-error" class="error-msg">Usuario o contrase√±a incorrectos</div>
        </div>
        <div class="modal-actions">
          <button type="submit" class="btn primary">Entrar</button>
          <button type="button" class="btn ghost" onclick="closeAuthModal()">Cancelar</button>
        </div>
        <div class="toggle-form">
          ¬øNo tienes cuenta? <span class="text-link" onclick="showRegisterForm()"
            style="cursor:pointer; color:var(--primary-color);">Crear cuenta</span>
        </div>
      </form>

      <!-- Register Form -->
      <form id="register-form" class="login-form" style="display:none;" onsubmit="handleRegister(event)">
        <div class="form-group">
          <label for="register-username">Usuario</label>
          <input type="text" id="register-username" name="username" required autocomplete="username">
        </div>
        <div class="form-group">
          <label for="register-password">Contrase√±a</label>
          <input type="password" id="register-password" name="password" required autocomplete="new-password"
            minlength="6">
          <div id="register-error" class="error-msg">Error al crear la cuenta</div>
          <div id="register-success" class="success-msg">¬°Cuenta creada! Iniciando sesi√≥n...</div>
        </div>
        <div class="modal-actions">
          <button type="submit" class="btn primary">Crear cuenta</button>
          <button type="button" class="btn ghost" onclick="closeAuthModal()">Cancelar</button>
        </div>
        <div class="toggle-form">
          ¬øYa tienes cuenta? <span class="text-link" onclick="showLoginForm(event)"
            style="cursor:pointer; color:var(--primary-color);">Iniciar sesi√≥n</span>
        </div>
      </form>
    </div>
  </div>

  <!-- Profile Modal -->
  <div id="profile-modal-overlay" class="modal-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-card" role="document">
      <div class="modal-head">
        <h3 class="modal-title">Mi Perfil</h3>
        <button class="btn ghost" onclick="closeProfileModal()" aria-label="Cerrar">‚úï</button>
      </div>

      <div style="margin-top:20px;">
        <div class="user-info" style="justify-content:center; padding:16px; cursor:default;">
          <div class="user-avatar" id="profile-avatar" style="width:48px; height:48px; font-size:20px;">U</div>
          <span class="user-name" id="profile-username" style="font-size:18px;">Usuario</span>
        </div>

        <!-- Change Username Form -->
        <form id="change-username-form" class="login-form" style="margin-top:24px;"
          onsubmit="handleChangeUsername(event)">
          <div class="form-group">
            <label for="new-username">Nuevo nombre de usuario</label>
            <input type="text" id="new-username" name="username" required autocomplete="username">
            <div id="username-change-error" class="error-msg">Este nombre de usuario ya est√° en uso</div>
            <div id="username-change-success" class="success-msg">¬°Nombre de usuario actualizado!</div>
          </div>
          <div class="modal-actions">
            <button type="submit" class="btn primary">Cambiar nombre</button>
          </div>
        </form>

        <!-- Change Password Form -->
        <form id="change-password-form" class="login-form" style="margin-top:16px;"
          onsubmit="handleChangePassword(event)">
          <div class="form-group">
            <label for="current-password">Contrase√±a actual</label>
            <input type="password" id="current-password" name="current-password" required
              autocomplete="current-password">
          </div>
          <div class="form-group">
            <label for="new-password">Nueva contrase√±a</label>
            <input type="password" id="new-password" name="new-password" required autocomplete="new-password"
              minlength="6">
            <div id="password-change-error" class="error-msg">Contrase√±a actual incorrecta</div>
            <div id="password-change-success" class="success-msg">¬°Contrase√±a actualizada!</div>
          </div>
          <div class="modal-actions">
            <button type="submit" class="btn primary">Cambiar contrase√±a</button>
          </div>
        </form>

        <div style="margin-top:24px; padding-top:16px; border-top:1px solid rgba(255,255,255,.12);">
          <button class="btn ghost" onclick="deleteAccount()" style="color:#ff6b6b; width:100%;">Eliminar
            cuenta</button>
        </div>
      </div>
    </div>
  </div>



  <script src="app.js" defer></script>
</body>

</html>